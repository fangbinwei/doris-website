"use strict";(self.webpackChunkselectdb_portal=self.webpackChunkselectdb_portal||[]).push([[52656],{3905:(n,e,a)=>{a.d(e,{Zo:()=>i,kt:()=>h});var t=a(67294);function s(n,e,a){return e in n?Object.defineProperty(n,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[e]=a,n}function r(n,e){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.push.apply(a,t)}return a}function o(n){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach((function(e){s(n,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(a,e))}))}return n}function d(n,e){if(null==n)return{};var a,t,s=function(n,e){if(null==n)return{};var a,t,s={},r=Object.keys(n);for(t=0;t<r.length;t++)a=r[t],e.indexOf(a)>=0||(s[a]=n[a]);return s}(n,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);for(t=0;t<r.length;t++)a=r[t],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(n,a)&&(s[a]=n[a])}return s}var l=t.createContext({}),p=function(n){var e=t.useContext(l),a=e;return n&&(a="function"==typeof n?n(e):o(o({},e),n)),a},i=function(n){var e=p(n.components);return t.createElement(l.Provider,{value:e},n.children)},_="mdxType",m={inlineCode:"code",wrapper:function(n){var e=n.children;return t.createElement(t.Fragment,{},e)}},f=t.forwardRef((function(n,e){var a=n.components,s=n.mdxType,r=n.originalType,l=n.parentName,i=d(n,["components","mdxType","originalType","parentName"]),_=p(a),f=s,h=_["".concat(l,".").concat(f)]||_[f]||m[f]||r;return a?t.createElement(h,o(o({ref:e},i),{},{components:a})):t.createElement(h,o({ref:e},i))}));function h(n,e){var a=arguments,s=e&&e.mdxType;if("string"==typeof n||s){var r=a.length,o=new Array(r);o[0]=f;var d={};for(var l in e)hasOwnProperty.call(e,l)&&(d[l]=e[l]);d.originalType=n,d[_]="string"==typeof n?n:s,o[1]=d;for(var p=2;p<r;p++)o[p]=a[p];return t.createElement.apply(null,o)}return t.createElement.apply(null,a)}f.displayName="MDXCreateElement"},75043:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>_,frontMatter:()=>r,metadata:()=>d,toc:()=>p});var t=a(87462),s=(a(67294),a(3905));const r={title:"BROKER LOAD",language:"zh-CN"},o=void 0,d={unversionedId:"sql-reference/sql-statements/Data-Manipulation/BROKER-LOAD",id:"version-0.15/sql-reference/sql-statements/Data-Manipulation/BROKER-LOAD",title:"BROKER LOAD",description:"\x3c!--",source:"@site/i18n/zh-CN/docusaurus-plugin-content-docs/version-0.15/sql-reference/sql-statements/Data-Manipulation/BROKER-LOAD.md",sourceDirName:"sql-reference/sql-statements/Data-Manipulation",slug:"/sql-reference/sql-statements/Data-Manipulation/BROKER-LOAD",permalink:"/zh-CN/docs/0.15/sql-reference/sql-statements/Data-Manipulation/BROKER-LOAD",draft:!1,tags:[],version:"0.15",frontMatter:{title:"BROKER LOAD",language:"zh-CN"},sidebar:"docs",previous:{title:"SHOW FUNCTIONS",permalink:"/zh-CN/docs/0.15/sql-reference/sql-statements/Data-Definition/show-functions"},next:{title:"CANCEL DELETE",permalink:"/zh-CN/docs/0.15/sql-reference/sql-statements/Data-Manipulation/CANCEL-DELETE"}},l={},p=[{value:"description",id:"description",level:2},{value:"example",id:"example",level:2},{value:"keyword",id:"keyword",level:2}],i={toc:p};function _(n){let{components:e,...a}=n;return(0,s.kt)("wrapper",(0,t.Z)({},i,a,{components:e,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"broker-load"},"BROKER LOAD"),(0,s.kt)("h2",{id:"description"},"description"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"Broker load \u901a\u8fc7\u968f Doris \u96c6\u7fa4\u4e00\u540c\u90e8\u7f72\u7684 broker \u8fdb\u884c\uff0c\u8bbf\u95ee\u5bf9\u5e94\u6570\u636e\u6e90\u7684\u6570\u636e\uff0c\u8fdb\u884c\u6570\u636e\u5bfc\u5165\u3002\n\u53ef\u4ee5\u901a\u8fc7 show broker \u547d\u4ee4\u67e5\u770b\u5df2\u7ecf\u90e8\u7f72\u7684 broker\u3002\n\u76ee\u524d\u652f\u6301\u4ee5\u4e0b4\u79cd\u6570\u636e\u6e90\uff1a\n\n1. Baidu HDFS\uff1a\u767e\u5ea6\u5185\u90e8\u7684 hdfs\uff0c\u4ec5\u9650\u4e8e\u767e\u5ea6\u5185\u90e8\u4f7f\u7528\u3002\n2. Baidu AFS\uff1a\u767e\u5ea6\u5185\u90e8\u7684 afs\uff0c\u4ec5\u9650\u4e8e\u767e\u5ea6\u5185\u90e8\u4f7f\u7528\u3002\n3. Baidu Object Storage(BOS)\uff1a\u767e\u5ea6\u5bf9\u8c61\u5b58\u50a8\u3002\u4ec5\u9650\u767e\u5ea6\u5185\u90e8\u7528\u6237\u3001\u516c\u6709\u4e91\u7528\u6237\u6216\u5176\u4ed6\u53ef\u4ee5\u8bbf\u95ee BOS \u7684\u7528\u6237\u4f7f\u7528\u3002\n4. Apache HDFS\uff1a\u793e\u533a\u7248\u672c hdfs\u3002\n5. Amazon S3\uff1aAmazon\u5bf9\u8c61\u5b58\u50a8\u3002\n")),(0,s.kt)("p",null,"\u8bed\u6cd5\uff1a"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'LOAD LABEL load_label\n(\ndata_desc1[, data_desc2, ...]\n)\nWITH [BROKER broker_name | S3]\n[load_properties]\n[opt_properties];\n\n1. load_label\n\n    \u5f53\u524d\u5bfc\u5165\u6279\u6b21\u7684\u6807\u7b7e\u3002\u5728\u4e00\u4e2a database \u5185\u552f\u4e00\u3002\n    \u8bed\u6cd5\uff1a\n    [database_name.]your_label\n \n2. data_desc\n\n    \u7528\u4e8e\u63cf\u8ff0\u4e00\u6279\u5bfc\u5165\u6570\u636e\u3002\n    \u8bed\u6cd5\uff1a\n        [MERGE|APPEND|DELETE]\n        DATA INFILE\n        (\n        "file_path1"[, file_path2, ...]\n        )\n        [NEGATIVE]\n        INTO TABLE `table_name`\n        [PARTITION (p1, p2)]\n        [COLUMNS TERMINATED BY "column_separator"]\n        [FORMAT AS "file_type"]\n        [(column_list)]\n        [PRECEDING FILTER predicate]\n        [SET (k1 = func(k2))]\n        [WHERE predicate]\n        [DELETE ON label=true]\n        [ORDER BY source_sequence]\n        [read_properties]\n\n    \u8bf4\u660e\uff1a\n        file_path: \n\n        \u6587\u4ef6\u8def\u5f84\uff0c\u53ef\u4ee5\u6307\u5b9a\u5230\u4e00\u4e2a\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u7528 * \u901a\u914d\u7b26\u6307\u5b9a\u67d0\u4e2a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u3002\u901a\u914d\u7b26\u5fc5\u987b\u5339\u914d\u5230\u6587\u4ef6\uff0c\u800c\u4e0d\u80fd\u662f\u76ee\u5f55\u3002\n\n        PARTITION:\n\n        \u5982\u679c\u6307\u5b9a\u6b64\u53c2\u6570\uff0c\u5219\u53ea\u4f1a\u5bfc\u5165\u6307\u5b9a\u7684\u5206\u533a\uff0c\u5bfc\u5165\u5206\u533a\u4ee5\u5916\u7684\u6570\u636e\u4f1a\u88ab\u8fc7\u6ee4\u6389\u3002\n        \u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u9ed8\u8ba4\u5bfc\u5165table\u7684\u6240\u6709\u5206\u533a\u3002\n    \n        NEGATIVE\uff1a\n        \u5982\u679c\u6307\u5b9a\u6b64\u53c2\u6570\uff0c\u5219\u76f8\u5f53\u4e8e\u5bfc\u5165\u4e00\u6279\u201c\u8d1f\u201d\u6570\u636e\u3002\u7528\u4e8e\u62b5\u6d88\u4e4b\u524d\u5bfc\u5165\u7684\u540c\u4e00\u6279\u6570\u636e\u3002\n        \u8be5\u53c2\u6570\u4ec5\u9002\u7528\u4e8e\u5b58\u5728 value \u5217\uff0c\u5e76\u4e14 value \u5217\u7684\u805a\u5408\u7c7b\u578b\u4ec5\u4e3a SUM \u7684\u60c5\u51b5\u3002\n        \n        column_separator\uff1a\n\n        \u7528\u4e8e\u6307\u5b9a\u5bfc\u5165\u6587\u4ef6\u4e2d\u7684\u5217\u5206\u9694\u7b26\u3002\u9ed8\u8ba4\u4e3a \\t\n        \u5982\u679c\u662f\u4e0d\u53ef\u89c1\u5b57\u7b26\uff0c\u5219\u9700\u8981\u52a0\\\\x\u4f5c\u4e3a\u524d\u7f00\uff0c\u4f7f\u7528\u5341\u516d\u8fdb\u5236\u6765\u8868\u793a\u5206\u9694\u7b26\u3002\n        \u5982hive\u6587\u4ef6\u7684\u5206\u9694\u7b26\\x01\uff0c\u6307\u5b9a\u4e3a"\\\\x01"\n        \n        file_type\uff1a\n\n        \u7528\u4e8e\u6307\u5b9a\u5bfc\u5165\u6587\u4ef6\u7684\u7c7b\u578b\uff0c\u4f8b\u5982\uff1aparquet\u3001orc\u3001csv\u3002\u9ed8\u8ba4\u503c\u901a\u8fc7\u6587\u4ef6\u540e\u7f00\u540d\u5224\u65ad\u3002 \n\n        column_list\uff1a\n\n        \u7528\u4e8e\u6307\u5b9a\u5bfc\u5165\u6587\u4ef6\u4e2d\u7684\u5217\u548c table \u4e2d\u7684\u5217\u7684\u5bf9\u5e94\u5173\u7cfb\u3002\n        \u5f53\u9700\u8981\u8df3\u8fc7\u5bfc\u5165\u6587\u4ef6\u4e2d\u7684\u67d0\u4e00\u5217\u65f6\uff0c\u5c06\u8be5\u5217\u6307\u5b9a\u4e3a table \u4e2d\u4e0d\u5b58\u5728\u7684\u5217\u540d\u5373\u53ef\u3002\n        \u8bed\u6cd5\uff1a\n        (col_name1, col_name2, ...)\n\n        PRECEDING FILTER predicate:\n\n        \u7528\u4e8e\u8fc7\u6ee4\u539f\u59cb\u6570\u636e\u3002\u539f\u59cb\u6570\u636e\u662f\u672a\u7ecf\u5217\u6620\u5c04\u3001\u8f6c\u6362\u7684\u6570\u636e\u3002\u7528\u6237\u53ef\u4ee5\u5728\u5bf9\u8f6c\u6362\u524d\u7684\u6570\u636e\u524d\u8fdb\u884c\u4e00\u6b21\u8fc7\u6ee4\uff0c\u9009\u53d6\u671f\u671b\u7684\u6570\u636e\uff0c\u518d\u8fdb\u884c\u8f6c\u6362\u3002\n        \n        SET:\n\n        \u5982\u679c\u6307\u5b9a\u6b64\u53c2\u6570\uff0c\u53ef\u4ee5\u5c06\u6e90\u6587\u4ef6\u67d0\u4e00\u5217\u6309\u7167\u51fd\u6570\u8fdb\u884c\u8f6c\u5316\uff0c\u7136\u540e\u5c06\u8f6c\u5316\u540e\u7684\u7ed3\u679c\u5bfc\u5165\u5230table\u4e2d\u3002\u8bed\u6cd5\u4e3a `column_name` = expression\u3002\u4e3e\u51e0\u4e2a\u4f8b\u5b50\u5e2e\u52a9\u7406\u89e3\u3002\n        \u4f8b1: \u8868\u4e2d\u67093\u4e2a\u5217\u201cc1, c2, c3", \u6e90\u6587\u4ef6\u4e2d\u524d\u4e24\u5217\u4f9d\u6b21\u5bf9\u5e94(c1,c2)\uff0c\u540e\u4e24\u5217\u4e4b\u548c\u5bf9\u5e94c3\uff1b\u90a3\u4e48\u9700\u8981\u6307\u5b9a columns (c1,c2,tmp_c3,tmp_c4) SET (c3=tmp_c3+tmp_c4); \n        \u4f8b2: \u8868\u4e2d\u67093\u4e2a\u5217\u201cyear, month, day"\u4e09\u4e2a\u5217\uff0c\u6e90\u6587\u4ef6\u4e2d\u53ea\u6709\u4e00\u4e2a\u65f6\u95f4\u5217\uff0c\u4e3a\u201d2018-06-01 01:02:03\u201c\u683c\u5f0f\u3002\n        \u90a3\u4e48\u53ef\u4ee5\u6307\u5b9a columns(tmp_time) set (year = year(tmp_time), month=month(tmp_time), day=day(tmp_time)) \u5b8c\u6210\u5bfc\u5165\u3002\n\n        WHERE:\n      \n        \u5bf9\u505a\u5b8c transform \u7684\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\uff0c\u7b26\u5408 where \u6761\u4ef6\u7684\u6570\u636e\u624d\u80fd\u88ab\u5bfc\u5165\u3002WHERE \u8bed\u53e5\u4e2d\u53ea\u53ef\u5f15\u7528\u8868\u4e2d\u5217\u540d\u3002\n\n        merge_type:\n\n        \u6570\u636e\u7684\u5408\u5e76\u7c7b\u578b\uff0c\u4e00\u5171\u652f\u6301\u4e09\u79cd\u7c7b\u578bAPPEND\u3001DELETE\u3001MERGE \u5176\u4e2d\uff0cAPPEND\u662f\u9ed8\u8ba4\u503c\uff0c\u8868\u793a\u8fd9\u6279\u6570\u636e\u5168\u90e8\u9700\u8981\u8ffd\u52a0\u5230\u73b0\u6709\u6570\u636e\u4e2d\uff0cDELETE \u8868\u793a\u5220\u9664\u4e0e\u8fd9\u6279\u6570\u636ekey\u76f8\u540c\u7684\u6240\u6709\u884c\uff0cMERGE \u8bed\u4e49 \u9700\u8981\u4e0edelete on\u6761\u4ef6\u8054\u5408\u4f7f\u7528\uff0c\u8868\u793a\u6ee1\u8db3delete \u6761\u4ef6\u7684\u6570\u636e\u6309\u7167DELETE \u8bed\u4e49\u5904\u7406\u5176\u4f59\u7684\u6309\u7167APPEND \u8bed\u4e49\u5904\u7406,\n\n        delete_on_predicates:\n\n        \u8868\u793a\u5220\u9664\u6761\u4ef6\uff0c\u4ec5\u5728 merge type \u4e3aMERGE \u65f6\u6709\u610f\u4e49\uff0c\u8bed\u6cd5\u4e0ewhere \u76f8\u540c\n        \n        ORDER BY:\n        \n        \u53ea\u9002\u7528\u4e8eUNIQUE_KEYS,\u76f8\u540ckey\u5217\u4e0b\uff0c\u4fdd\u8bc1value\u5217\u6309\u7167source_sequence\u8fdb\u884cREPLACE, source_sequence\u53ef\u4ee5\u662f\u6570\u636e\u6e90\u4e2d\u7684\u5217\uff0c\u4e5f\u53ef\u4ee5\u662f\u8868\u7ed3\u6784\u4e2d\u7684\u4e00\u5217\u3002\n\n        read_properties:\n\n        \u7528\u4e8e\u6307\u5b9a\u4e00\u4e9b\u7279\u6b8a\u53c2\u6570\u3002\n        \u8bed\u6cd5\uff1a\n        [PROPERTIES ("key"="value", ...)]\n\n        \u53ef\u4ee5\u6307\u5b9a\u5982\u4e0b\u53c2\u6570\uff1a\n\n        line_delimiter\uff1a \u7528\u4e8e\u6307\u5b9a\u5bfc\u5165\u6587\u4ef6\u4e2d\u7684\u6362\u884c\u7b26\uff0c\u9ed8\u8ba4\u4e3a\\n\u3002\u53ef\u4ee5\u4f7f\u7528\u505a\u591a\u4e2a\u5b57\u7b26\u7684\u7ec4\u5408\u4f5c\u4e3a\u6362\u884c\u7b26\u3002\n\n        fuzzy_parse\uff1a \u5e03\u5c14\u7c7b\u578b\uff0c\u4e3atrue\u8868\u793ajson\u5c06\u4ee5\u7b2c\u4e00\u884c\u4e3aschema \u8fdb\u884c\u89e3\u6790\uff0c\u5f00\u542f\u8fd9\u4e2a\u9009\u9879\u53ef\u4ee5\u63d0\u9ad8json \u5bfc\u5165\u6548\u7387\uff0c\u4f46\u662f\u8981\u6c42\u6240\u6709json \u5bf9\u8c61\u7684key\u7684\u987a\u5e8f\u548c\u7b2c\u4e00\u884c\u4e00\u81f4\uff0c \u9ed8\u8ba4\u4e3afalse\uff0c\u4ec5\u7528\u4e8ejson\u683c\u5f0f\u3002\n\n        jsonpaths: \u5bfc\u5165json\u65b9\u5f0f\u5206\u4e3a\uff1a\u7b80\u5355\u6a21\u5f0f\u548c\u5339\u914d\u6a21\u5f0f\u3002\n        \u7b80\u5355\u6a21\u5f0f\uff1a\u6ca1\u6709\u8bbe\u7f6ejsonpaths\u53c2\u6570\u5373\u4e3a\u7b80\u5355\u6a21\u5f0f\uff0c\u8fd9\u79cd\u6a21\u5f0f\u4e0b\u8981\u6c42json\u6570\u636e\u662f\u5bf9\u8c61\u7c7b\u578b\uff0c\u4f8b\u5982\uff1a\n        {"k1":1, "k2":2, "k3":"hello"}\uff0c\u5176\u4e2dk1\uff0ck2\uff0ck3\u662f\u5217\u540d\u5b57\u3002\n        \u5339\u914d\u6a21\u5f0f\uff1a\u7528\u4e8ejson\u6570\u636e\u76f8\u5bf9\u590d\u6742\uff0c\u9700\u8981\u901a\u8fc7jsonpaths\u53c2\u6570\u5339\u914d\u5bf9\u5e94\u7684value\u3002\n\n        strip_outer_array: \u5e03\u5c14\u7c7b\u578b\uff0c\u4e3atrue\u8868\u793ajson\u6570\u636e\u4ee5\u6570\u7ec4\u5bf9\u8c61\u5f00\u59cb\u4e14\u5c06\u6570\u7ec4\u5bf9\u8c61\u4e2d\u8fdb\u884c\u5c55\u5e73\uff0c\u9ed8\u8ba4\u503c\u662ffalse\u3002\u4f8b\u5982\uff1a\n        [\n         {"k1" : 1, "v1" : 2},\n         {"k1" : 3, "v1" : 4}\n         ]\n         \u5f53strip_outer_array\u4e3atrue\uff0c\u6700\u540e\u5bfc\u5165\u5230doris\u4e2d\u4f1a\u751f\u6210\u4e24\u884c\u6570\u636e\u3002\n\n         json_root: json_root\u4e3a\u5408\u6cd5\u7684jsonpath\u5b57\u7b26\u4e32\uff0c\u7528\u4e8e\u6307\u5b9ajson document\u7684\u6839\u8282\u70b9\uff0c\u9ed8\u8ba4\u503c\u4e3a""\u3002\n\n         num_as_string\uff1a \u5e03\u5c14\u7c7b\u578b\uff0c\u4e3atrue\u8868\u793a\u5728\u89e3\u6790json\u6570\u636e\u65f6\u4f1a\u5c06\u6570\u5b57\u7c7b\u578b\u8f6c\u4e3a\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u5728\u786e\u4fdd\u4e0d\u4f1a\u51fa\u73b0\u7cbe\u5ea6\u4e22\u5931\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u5bfc\u5165\u3002\n\n  3. broker_name\n\n    \u6240\u4f7f\u7528\u7684 broker \u540d\u79f0\uff0c\u53ef\u4ee5\u901a\u8fc7 show broker \u547d\u4ee4\u67e5\u770b\u3002\n\n4. load_properties\n\n    \u7528\u4e8e\u63d0\u4f9b\u901a\u8fc7 broker \u8bbf\u95ee\u6570\u636e\u6e90\u7684\u4fe1\u606f\u3002\u4e0d\u540c\u7684 broker\uff0c\u4ee5\u53ca\u4e0d\u540c\u7684\u8bbf\u95ee\u65b9\u5f0f\uff0c\u9700\u8981\u63d0\u4f9b\u7684\u4fe1\u606f\u4e0d\u540c\u3002\n\n    1. Baidu HDFS/AFS\n\n        \u8bbf\u95ee\u767e\u5ea6\u5185\u90e8\u7684 hdfs/afs \u76ee\u524d\u4ec5\u652f\u6301\u7b80\u5355\u8ba4\u8bc1\uff0c\u9700\u63d0\u4f9b\uff1a\n        username\uff1ahdfs \u7528\u6237\u540d\n        password\uff1ahdfs \u5bc6\u7801\n\n    2. BOS\n\n        \u9700\u63d0\u4f9b\uff1a\n        bos_endpoint\uff1aBOS \u7684endpoint\n        bos_accesskey\uff1a\u516c\u6709\u4e91\u7528\u6237\u7684 accesskey\n        bos_secret_accesskey\uff1a\u516c\u6709\u4e91\u7528\u6237\u7684 secret_accesskey\n    \n    3. Apache HDFS\n\n        \u793e\u533a\u7248\u672c\u7684 hdfs\uff0c\u652f\u6301\u7b80\u5355\u8ba4\u8bc1\u3001kerberos \u8ba4\u8bc1\u3002\u4ee5\u53ca\u652f\u6301 HA \u914d\u7f6e\u3002\n        \u7b80\u5355\u8ba4\u8bc1\uff1a\n        hadoop.security.authentication = simple (\u9ed8\u8ba4)\n        username\uff1ahdfs \u7528\u6237\u540d\n        password\uff1ahdfs \u5bc6\u7801\n\n        kerberos \u8ba4\u8bc1\uff1a\n        hadoop.security.authentication = kerberos\n        kerberos_principal\uff1a\u6307\u5b9a kerberos \u7684 principal\n        kerberos_keytab\uff1a\u6307\u5b9a kerberos \u7684 keytab \u6587\u4ef6\u8def\u5f84\u3002\u8be5\u6587\u4ef6\u5fc5\u987b\u4e3a broker \u8fdb\u7a0b\u6240\u5728\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\u3002\n        kerberos_keytab_content\uff1a\u6307\u5b9a kerberos \u4e2d keytab \u6587\u4ef6\u5185\u5bb9\u7ecf\u8fc7 base64 \u7f16\u7801\u4e4b\u540e\u7684\u5185\u5bb9\u3002\u8fd9\u4e2a\u8ddf kerberos_keytab \u914d\u7f6e\u4e8c\u9009\u4e00\u5c31\u53ef\u4ee5\u3002\n\n        namenode HA\uff1a\n        \u901a\u8fc7\u914d\u7f6e namenode HA\uff0c\u53ef\u4ee5\u5728 namenode \u5207\u6362\u65f6\uff0c\u81ea\u52a8\u8bc6\u522b\u5230\u65b0\u7684 namenode\n        dfs.nameservices: \u6307\u5b9a hdfs \u670d\u52a1\u7684\u540d\u5b57\uff0c\u81ea\u5b9a\u4e49\uff0c\u5982\uff1a"dfs.nameservices" = "my_ha"\n        dfs.ha.namenodes.xxx\uff1a\u81ea\u5b9a\u4e49 namenode \u7684\u540d\u5b57,\u591a\u4e2a\u540d\u5b57\u4ee5\u9017\u53f7\u5206\u9694\u3002\u5176\u4e2d xxx \u4e3a dfs.nameservices \u4e2d\u81ea\u5b9a\u4e49\u7684\u540d\u5b57\uff0c\u5982 "dfs.ha.namenodes.my_ha" = "my_nn"\n        dfs.namenode.rpc-address.xxx.nn\uff1a\u6307\u5b9a namenode \u7684rpc\u5730\u5740\u4fe1\u606f\u3002\u5176\u4e2d nn \u8868\u793a dfs.ha.namenodes.xxx \u4e2d\u914d\u7f6e\u7684 namenode \u7684\u540d\u5b57\uff0c\u5982\uff1a"dfs.namenode.rpc-address.my_ha.my_nn" = "host:port"\n        dfs.client.failover.proxy.provider\uff1a\u6307\u5b9a client \u8fde\u63a5 namenode \u7684 provider\uff0c\u9ed8\u8ba4\u4e3a\uff1aorg.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider\n\n    4. Amazon S3\n\n        \u9700\u63d0\u4f9b\uff1a\n        fs.s3a.access.key\uff1aAmazonS3\u7684access key\n        fs.s3a.secret.key\uff1aAmazonS3\u7684secret key\n        fs.s3a.endpoint\uff1aAmazonS3\u7684endpoint \n    5. \u5982\u679c\u4f7f\u7528S3\u534f\u8bae\u76f4\u63a5\u8fde\u63a5\u8fdc\u7a0b\u5b58\u50a8\u65f6\u9700\u8981\u6307\u5b9a\u5982\u4e0b\u5c5e\u6027\n\n        (\n            "AWS_ENDPOINT" = "",\n            "AWS_ACCESS_KEY" = "",\n            "AWS_SECRET_KEY"="",\n            "AWS_REGION" = ""\n        )\n    6. \u5982\u679c\u4f7f\u7528HDFS\u534f\u8bae\u76f4\u63a5\u8fde\u63a5\u8fdc\u7a0b\u5b58\u50a8\u65f6\u9700\u8981\u6307\u5b9a\u5982\u4e0b\u5c5e\u6027\n        (\n            "fs.defaultFS" = "",\n            "hdfs_user"="",\n            "kerb_principal" = "",\n            "kerb_ticket_cache_path" = "",\n            "kerb_token" = ""\n        )\n        fs.defaultFS: hdfs\u96c6\u7fa4defaultFS\n        hdfs_user: \u8fde\u63a5hdfs\u96c6\u7fa4\u65f6\u4f7f\u7528\u7684\u7528\u6237\u540d\n        namenode HA\uff1a\n        \u901a\u8fc7\u914d\u7f6e namenode HA\uff0c\u53ef\u4ee5\u5728 namenode \u5207\u6362\u65f6\uff0c\u81ea\u52a8\u8bc6\u522b\u5230\u65b0\u7684 namenode\n        dfs.nameservices: \u6307\u5b9a hdfs \u670d\u52a1\u7684\u540d\u5b57\uff0c\u81ea\u5b9a\u4e49\uff0c\u5982\uff1a"dfs.nameservices" = "my_ha"\n        dfs.ha.namenodes.xxx\uff1a\u81ea\u5b9a\u4e49 namenode \u7684\u540d\u5b57,\u591a\u4e2a\u540d\u5b57\u4ee5\u9017\u53f7\u5206\u9694\u3002\u5176\u4e2d xxx \u4e3a dfs.nameservices \u4e2d\u81ea\u5b9a\u4e49\u7684\u540d\u5b57\uff0c\u5982 "dfs.ha.namenodes.my_ha" = "my_nn"\n        dfs.namenode.rpc-address.xxx.nn\uff1a\u6307\u5b9a namenode \u7684rpc\u5730\u5740\u4fe1\u606f\u3002\u5176\u4e2d nn \u8868\u793a dfs.ha.namenodes.xxx \u4e2d\u914d\u7f6e\u7684 namenode \u7684\u540d\u5b57\uff0c\u5982\uff1a"dfs.namenode.rpc-address.my_ha.my_nn" = "host:port"\n        dfs.client.failover.proxy.provider\uff1a\u6307\u5b9a client \u8fde\u63a5 namenode \u7684 provider\uff0c\u9ed8\u8ba4\u4e3a\uff1aorg.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider\n    \n4. opt_properties\n\n    \u7528\u4e8e\u6307\u5b9a\u4e00\u4e9b\u7279\u6b8a\u53c2\u6570\u3002\n    \u8bed\u6cd5\uff1a\n    [PROPERTIES ("key"="value", ...)]\n    \n    \u53ef\u4ee5\u6307\u5b9a\u5982\u4e0b\u53c2\u6570\uff1a\n    timeout\uff1a         \u6307\u5b9a\u5bfc\u5165\u64cd\u4f5c\u7684\u8d85\u65f6\u65f6\u95f4\u3002\u9ed8\u8ba4\u8d85\u65f6\u4e3a4\u5c0f\u65f6\u3002\u5355\u4f4d\u79d2\u3002\n    max_filter_ratio\uff1a\u6700\u5927\u5bb9\u5fcd\u53ef\u8fc7\u6ee4\uff08\u6570\u636e\u4e0d\u89c4\u8303\u7b49\u539f\u56e0\uff09\u7684\u6570\u636e\u6bd4\u4f8b\u3002\u9ed8\u8ba4\u96f6\u5bb9\u5fcd\u3002\n    exec_mem_limit\uff1a  \u5bfc\u5165\u5185\u5b58\u9650\u5236\u3002\u9ed8\u8ba4\u4e3a 2GB\u3002\u5355\u4f4d\u4e3a\u5b57\u8282\u3002\n    strict mode\uff1a     \u662f\u5426\u5bf9\u6570\u636e\u8fdb\u884c\u4e25\u683c\u9650\u5236\u3002\u9ed8\u8ba4\u4e3a false\u3002\n    timezone:         \u6307\u5b9a\u67d0\u4e9b\u53d7\u65f6\u533a\u5f71\u54cd\u7684\u51fd\u6570\u7684\u65f6\u533a\uff0c\u5982 strftime/alignment_timestamp/from_unixtime \u7b49\u7b49\uff0c\u5177\u4f53\u8bf7\u67e5\u9605 [\u65f6\u533a] \u6587\u6863\u3002\u5982\u679c\u4e0d\u6307\u5b9a\uff0c\u5219\u4f7f\u7528 "Asia/Shanghai" \u65f6\u533a\u3002\n    send_batch_parallelism: \u7528\u4e8e\u8bbe\u7f6e\u53d1\u9001\u6279\u5904\u7406\u6570\u636e\u7684\u5e76\u884c\u5ea6\uff0c\u5982\u679c\u5e76\u884c\u5ea6\u7684\u503c\u8d85\u8fc7 BE \u914d\u7f6e\u4e2d\u7684 `max_send_batch_parallelism_per_job`\uff0c\u90a3\u4e48\u4f5c\u4e3a\u534f\u8c03\u70b9\u7684 BE \u5c06\u4f7f\u7528 `max_send_batch_parallelism_per_job` \u7684\u503c\u3002\n\n5. \u5bfc\u5165\u6570\u636e\u683c\u5f0f\u6837\u4f8b\n\n    \u6574\u578b\u7c7b\uff08TINYINT/SMALLINT/INT/BIGINT/LARGEINT\uff09\uff1a1, 1000, 1234\n    \u6d6e\u70b9\u7c7b\uff08FLOAT/DOUBLE/DECIMAL\uff09\uff1a1.1, 0.23, .356\n    \u65e5\u671f\u7c7b\uff08DATE/DATETIME\uff09\uff1a2017-10-03, 2017-06-13 12:34:03\u3002\n    \uff08\u6ce8\uff1a\u5982\u679c\u662f\u5176\u4ed6\u65e5\u671f\u683c\u5f0f\uff0c\u53ef\u4ee5\u5728\u5bfc\u5165\u547d\u4ee4\u4e2d\uff0c\u4f7f\u7528 strftime \u6216\u8005 time_format \u51fd\u6570\u8fdb\u884c\u8f6c\u6362\uff09\n    \u5b57\u7b26\u4e32\u7c7b\uff08CHAR/VARCHAR\uff09\uff1a"I am a student", "a"\n    NULL\u503c\uff1a\\N\n')),(0,s.kt)("h2",{id:"example"},"example"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},'1. \u4ece HDFS \u5bfc\u5165\u4e00\u6279\u6570\u636e\uff0c\u6307\u5b9a\u8d85\u65f6\u65f6\u95f4\u548c\u8fc7\u6ee4\u6bd4\u4f8b\u3002\u4f7f\u7528\u660e\u6587 my_hdfs_broker \u7684 broker\u3002\u7b80\u5355\u8ba4\u8bc1\u3002\n\n    LOAD LABEL example_db.label1\n    (\n    DATA INFILE("hdfs://hdfs_host:hdfs_port/user/palo/data/input/file")\n    INTO TABLE `my_table`\n    )\n    WITH BROKER my_hdfs_broker\n    (\n    "username" = "hdfs_user",\n    "password" = "hdfs_passwd"\n    )\n    PROPERTIES\n    (\n    "timeout" = "3600",\n    "max_filter_ratio" = "0.1"\n    );\n\n    \u5176\u4e2d hdfs_host \u4e3a namenode \u7684 host\uff0chdfs_port \u4e3a fs.defaultFS \u7aef\u53e3\uff08\u9ed8\u8ba49000\uff09\n\n2. \u4ece AFS \u4e00\u6279\u6570\u636e\uff0c\u5305\u542b\u591a\u4e2a\u6587\u4ef6\u3002\u5bfc\u5165\u4e0d\u540c\u7684 table\uff0c\u6307\u5b9a\u5206\u9694\u7b26\uff0c\u6307\u5b9a\u5217\u5bf9\u5e94\u5173\u7cfb\u3002\n\n    LOAD LABEL example_db.label2\n    (\n    DATA INFILE("afs://afs_host:hdfs_port/user/palo/data/input/file1")\n    INTO TABLE `my_table_1`\n    COLUMNS TERMINATED BY ","\n    (k1, k3, k2, v1, v2),\n    DATA INFILE("afs://afs_host:hdfs_port/user/palo/data/input/file2")\n    INTO TABLE `my_table_2`\n    COLUMNS TERMINATED BY "\\t"\n    (k1, k2, k3, v2, v1)\n    )\n    WITH BROKER my_afs_broker\n    (\n    "username" = "afs_user",\n    "password" = "afs_passwd"\n    )\n    PROPERTIES\n    (\n    "timeout" = "3600",\n    "max_filter_ratio" = "0.1"\n    );\n    \n\n3. \u4ece HDFS \u5bfc\u5165\u4e00\u6279\u6570\u636e\uff0c\u6307\u5b9ahive\u7684\u9ed8\u8ba4\u5206\u9694\u7b26\\x01\uff0c\u5e76\u4f7f\u7528\u901a\u914d\u7b26*\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u3002\n   \u4f7f\u7528\u7b80\u5355\u8ba4\u8bc1\uff0c\u540c\u65f6\u914d\u7f6e namenode HA\n\n    LOAD LABEL example_db.label3\n    (\n    DATA INFILE("hdfs://hdfs_host:hdfs_port/user/palo/data/input/*")\n    INTO TABLE `my_table`\n    COLUMNS TERMINATED BY "\\\\x01"\n    )\n    WITH BROKER my_hdfs_broker\n    (\n    "username" = "hdfs_user",\n    "password" = "hdfs_passwd",\n    "dfs.nameservices" = "my_ha",\n    "dfs.ha.namenodes.my_ha" = "my_namenode1, my_namenode2",\n    "dfs.namenode.rpc-address.my_ha.my_namenode1" = "nn1_host:rpc_port",\n    "dfs.namenode.rpc-address.my_ha.my_namenode2" = "nn2_host:rpc_port",\n    "dfs.client.failover.proxy.provider" = "org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider"\n    )\n\n4. \u4ece HDFS \u5bfc\u5165\u4e00\u6279\u201c\u8d1f\u201d\u6570\u636e\u3002\u540c\u65f6\u4f7f\u7528 kerberos \u8ba4\u8bc1\u65b9\u5f0f\u3002\u63d0\u4f9b keytab \u6587\u4ef6\u8def\u5f84\u3002\n\n    LOAD LABEL example_db.label4\n    (\n    DATA INFILE("hdfs://hdfs_host:hdfs_port/user/palo/data/input/old_file)\n    NEGATIVE\n    INTO TABLE `my_table`\n    COLUMNS TERMINATED BY "\\t"\n    )\n    WITH BROKER my_hdfs_broker\n    (\n    "hadoop.security.authentication" = "kerberos",\n    "kerberos_principal"="doris@YOUR.COM",\n    "kerberos_keytab"="/home/palo/palo.keytab"\n    )\n\n5. \u4ece HDFS \u5bfc\u5165\u4e00\u6279\u6570\u636e\uff0c\u6307\u5b9a\u5206\u533a\u3002\u540c\u65f6\u4f7f\u7528 kerberos \u8ba4\u8bc1\u65b9\u5f0f\u3002\u63d0\u4f9b base64 \u7f16\u7801\u540e\u7684 keytab \u6587\u4ef6\u5185\u5bb9\u3002\n\n    LOAD LABEL example_db.label5\n    (\n    DATA INFILE("hdfs://hdfs_host:hdfs_port/user/palo/data/input/file")\n    INTO TABLE `my_table`\n    PARTITION (p1, p2)\n    COLUMNS TERMINATED BY ","\n    (k1, k3, k2, v1, v2)\n    )\n    WITH BROKER my_hdfs_broker\n    (\n    "hadoop.security.authentication"="kerberos",\n    "kerberos_principal"="doris@YOUR.COM",\n    "kerberos_keytab_content"="BQIAAABEAAEACUJBSURVLkNPTQAEcGFsbw"\n    )\n\n6. \u4ece BOS \u5bfc\u5165\u4e00\u6279\u6570\u636e\uff0c\u6307\u5b9a\u5206\u533a, \u5e76\u5bf9\u5bfc\u5165\u6587\u4ef6\u7684\u5217\u505a\u4e00\u4e9b\u8f6c\u5316\uff0c\u5982\u4e0b\uff1a\n   \u8868\u7ed3\u6784\u4e3a\uff1a\n    k1 varchar(20)\n    k2 int\n\n    \u5047\u8bbe\u6570\u636e\u6587\u4ef6\u53ea\u6709\u4e00\u884c\u6570\u636e\uff1a\n\n    Adele,1,1\n\n    \u6570\u636e\u6587\u4ef6\u4e2d\u5404\u5217\uff0c\u5bf9\u5e94\u5bfc\u5165\u8bed\u53e5\u4e2d\u6307\u5b9a\u7684\u5404\u5217\uff1a\n    k1,tmp_k2,tmp_k3\n\n    \u8f6c\u6362\u5982\u4e0b\uff1a\n\n    1) k1: \u4e0d\u53d8\u6362\n    2) k2\uff1a\u662f tmp_k2 \u548c tmp_k3 \u6570\u636e\u4e4b\u548c\n\n    LOAD LABEL example_db.label6\n    (\n    DATA INFILE("bos://my_bucket/input/file")\n    INTO TABLE `my_table`\n    PARTITION (p1, p2)\n    COLUMNS TERMINATED BY ","\n    (k1, tmp_k2, tmp_k3)\n    SET (\n      k2 = tmp_k2 + tmp_k3\n    )\n    )\n    WITH BROKER my_bos_broker\n    (\n    "bos_endpoint" = "http://bj.bcebos.com",\n    "bos_accesskey" = "xxxxxxxxxxxxxxxxxxxxxxxxxx",\n    "bos_secret_accesskey"="yyyyyyyyyyyyyyyyyyyy"\n    )\n\n7. \u5bfc\u5165\u6570\u636e\u5230\u542b\u6709HLL\u5217\u7684\u8868\uff0c\u53ef\u4ee5\u662f\u8868\u4e2d\u7684\u5217\u6216\u8005\u6570\u636e\u91cc\u9762\u7684\u5217\n\n    \u5982\u679c\u8868\u4e2d\u67094\u5217\u5206\u522b\u662f\uff08id,v1,v2,v3\uff09\u3002\u5176\u4e2dv1\u548cv2\u5217\u662fhll\u5217\u3002\u5bfc\u5165\u7684\u6e90\u6587\u4ef6\u67093\u5217, \u5176\u4e2d\u8868\u4e2d\u7684\u7b2c\u4e00\u5217 = \u6e90\u6587\u4ef6\u4e2d\u7684\u7b2c\u4e00\u5217\uff0c\u800c\u8868\u4e2d\u7684\u7b2c\u4e8c\uff0c\u4e09\u5217\u4e3a\u6e90\u6587\u4ef6\u4e2d\u7684\u7b2c\u4e8c\uff0c\u4e09\u5217\u53d8\u6362\u5f97\u5230\uff0c\u8868\u4e2d\u7684\u7b2c\u56db\u5217\u5728\u6e90\u6587\u4ef6\u4e2d\u5e76\u4e0d\u5b58\u5728\u3002\n    \u5219\uff08column_list\uff09\u4e2d\u58f0\u660e\u7b2c\u4e00\u5217\u4e3aid\uff0c\u7b2c\u4e8c\u4e09\u5217\u4e3a\u4e00\u4e2a\u4e34\u65f6\u547d\u540d\u7684k1,k2\u3002\n    \u5728SET\u4e2d\u5fc5\u987b\u7ed9\u8868\u4e2d\u7684hll\u5217\u7279\u6b8a\u58f0\u660e hll_hash\u3002\u8868\u4e2d\u7684v1\u5217\u7b49\u4e8e\u539f\u59cb\u6570\u636e\u4e2d\u7684hll_hash(k1)\u5217, \u8868\u4e2d\u7684v3\u5217\u5728\u539f\u59cb\u6570\u636e\u4e2d\u5e76\u6ca1\u6709\u5bf9\u5e94\u7684\u503c\uff0c\u4f7f\u7528empty_hll\u8865\u5145\u9ed8\u8ba4\u503c\u3002\n    LOAD LABEL example_db.label7\n    (\n    DATA INFILE("hdfs://hdfs_host:hdfs_port/user/palo/data/input/file")\n    INTO TABLE `my_table`\n    PARTITION (p1, p2)\n    COLUMNS TERMINATED BY ","\n    (id, k1, k2)\n    SET (\n      v1 = hll_hash(k1),\n      v2 = hll_hash(k2),\n      v3 = empty_hll()\n    )\n    )\n    WITH BROKER hdfs ("username"="hdfs_user", "password"="hdfs_password");\n\n    LOAD LABEL example_db.label8\n    (\n    DATA INFILE("hdfs://hdfs_host:hdfs_port/user/palo/data/input/file")\n    INTO TABLE `my_table`\n    PARTITION (p1, p2)\n    COLUMNS TERMINATED BY ","\n    (k1, k2, tmp_k3, tmp_k4, v1, v2)\n    SET (\n      v1 = hll_hash(tmp_k3),\n      v2 = hll_hash(tmp_k4)\n    )\n    )\n    WITH BROKER hdfs ("username"="hdfs_user", "password"="hdfs_password");\n\n8. \u5bfc\u5165Parquet\u6587\u4ef6\u4e2d\u6570\u636e  \u6307\u5b9aFORMAT \u4e3aparquet\uff0c \u9ed8\u8ba4\u662f\u901a\u8fc7\u6587\u4ef6\u540e\u7f00\u5224\u65ad\n\n    LOAD LABEL example_db.label9\n    (\n    DATA INFILE("hdfs://hdfs_host:hdfs_port/user/palo/data/input/file")\n    INTO TABLE `my_table`\n    FORMAT AS "parquet"\n    (k1, k2, k3)\n    )\n    WITH BROKER hdfs ("username"="hdfs_user", "password"="hdfs_password");\n\n9. \u63d0\u53d6\u6587\u4ef6\u8def\u5f84\u4e2d\u7684\u5206\u533a\u5b57\u6bb5\n\n    \u5982\u679c\u9700\u8981\uff0c\u5219\u4f1a\u6839\u636e\u8868\u4e2d\u5b9a\u4e49\u7684\u5b57\u6bb5\u7c7b\u578b\u89e3\u6790\u6587\u4ef6\u8def\u5f84\u4e2d\u7684\u5206\u533a\u5b57\u6bb5\uff08partitioned fields\uff09\uff0c\u7c7b\u4f3cSpark\u4e2dPartition Discovery\u7684\u529f\u80fd\n\n    LOAD LABEL example_db.label10\n    (\n    DATA INFILE("hdfs://hdfs_host:hdfs_port/user/palo/data/input/dir/city=beijing/*/*")\n    INTO TABLE `my_table`\n    FORMAT AS "csv"\n    (k1, k2, k3)\n    COLUMNS FROM PATH AS (city, utc_date)\n    SET (uniq_id = md5sum(k1, city))\n    )\n    WITH BROKER hdfs ("username"="hdfs_user", "password"="hdfs_password");\n\n    hdfs://hdfs_host:hdfs_port/user/palo/data/input/dir/city=beijing\u76ee\u5f55\u4e0b\u5305\u62ec\u5982\u4e0b\u6587\u4ef6\uff1a\n\n    [hdfs://hdfs_host:hdfs_port/user/palo/data/input/dir/city=beijing/utc_date=2019-06-26/0000.csv, hdfs://hdfs_host:hdfs_port/user/palo/data/input/dir/city=beijing/utc_date=2019-06-26/0001.csv, ...]\n\n    \u5219\u63d0\u53d6\u6587\u4ef6\u8def\u5f84\u7684\u4e2d\u7684city\u548cutc_date\u5b57\u6bb5\n\n10. \u5bf9\u5f85\u5bfc\u5165\u6570\u636e\u8fdb\u884c\u8fc7\u6ee4\uff0ck1 \u503c\u5927\u4e8e k2 \u503c\u7684\u5217\u624d\u80fd\u88ab\u5bfc\u5165\n\n    LOAD LABEL example_db.label10\n    (\n    DATA INFILE("hdfs://hdfs_host:hdfs_port/user/palo/data/input/file")\n    INTO TABLE `my_table`\n    where k1 > k2\n    )\n\n11. \u4ece AmazonS3 \u5bfc\u5165Parquet\u6587\u4ef6\u4e2d\u6570\u636e\uff0c\u6307\u5b9a FORMAT \u4e3aparquet\uff0c\u9ed8\u8ba4\u662f\u901a\u8fc7\u6587\u4ef6\u540e\u7f00\u5224\u65ad\uff1a\n    \n    LOAD LABEL example_db.label11\n    (\n    DATA INFILE("s3a://my_bucket/input/file")\n    INTO TABLE `my_table`\n    FORMAT AS "parquet"\n    (k1, k2, k3)\n    )\n    WITH BROKER my_s3a_broker\n    (\n    "fs.s3a.access.key" = "xxxxxxxxxxxxxxxxxxxxxxxxxx",\n    "fs.s3a.secret.key" = "yyyyyyyyyyyyyyyyyyyy",\n    "fs.s3a.endpoint" = "s3.amazonaws.com"\n    )\n\n12. \u63d0\u53d6\u6587\u4ef6\u8def\u5f84\u4e2d\u7684\u65f6\u95f4\u5206\u533a\u5b57\u6bb5\uff0c\u5e76\u4e14\u65f6\u95f4\u5305\u542b %3A (\u5728 hdfs \u8def\u5f84\u4e2d\uff0c\u4e0d\u5141\u8bb8\u6709 \':\'\uff0c\u6240\u6709 \':\' \u4f1a\u7531 %3A \u66ff\u6362)\n\n    \u5047\u8bbe\u6709\u5982\u4e0b\u6587\u4ef6\uff1a\n\n    /user/data/data_time=2020-02-17 00%3A00%3A00/test.txt\n    /user/data/data_time=2020-02-18 00%3A00%3A00/test.txt\n\n    \u8868\u7ed3\u6784\u4e3a\uff1a\n    data_time DATETIME,\n    k2        INT,\n    k3        INT\n\n    LOAD LABEL example_db.label12\n    (\n     DATA INFILE("hdfs://host:port/user/data/*/test.txt") \n     INTO TABLE `tbl12`\n     COLUMNS TERMINATED BY ","\n     (k2,k3)\n     COLUMNS FROM PATH AS (data_time)\n     SET (data_time=str_to_date(data_time, \'%Y-%m-%d %H%%3A%i%%3A%s\'))\n    ) \n    WITH BROKER "hdfs" ("username"="user", "password"="pass");\n\n13. \u4ece HDFS \u5bfc\u5165\u4e00\u6279\u6570\u636e\uff0c\u6307\u5b9a\u8d85\u65f6\u65f6\u95f4\u548c\u8fc7\u6ee4\u6bd4\u4f8b\u3002\u4f7f\u7528\u660e\u6587 my_hdfs_broker \u7684 broker\u3002\u7b80\u5355\u8ba4\u8bc1\u3002\u5e76\u4e14\u5c06\u539f\u6709\u6570\u636e\u4e2d\u4e0e \u5bfc\u5165\u6570\u636e\u4e2dv2 \u5927\u4e8e100 \u7684\u5217\u76f8\u5339\u914d\u7684\u5217\u5220\u9664\uff0c\u5176\u4ed6\u5217\u6b63\u5e38\u5bfc\u5165\n\n    LOAD LABEL example_db.label1\n    (\n    MERGE DATA INFILE("hdfs://hdfs_host:hdfs_port/user/palo/data/input/file")\n    INTO TABLE `my_table`\n    COLUMNS TERMINATED BY "\\t"\n    (k1, k2, k3, v2, v1)\n    )\n    DELETE ON v2 >100\n    WITH BROKER my_hdfs_broker\n    (\n    "username" = "hdfs_user",\n    "password" = "hdfs_passwd"\n    )\n    PROPERTIES\n    (\n    "timeout" = "3600",\n    "max_filter_ratio" = "0.1"\n    );\n    \n14. \u5bfc\u5165\u65f6\u6307\u5b9asource_sequence\u5217\uff0c\u4fdd\u8bc1UNIQUE_KEYS\u8868\u4e2d\u7684\u66ff\u6362\u987a\u5e8f\uff1a\n    LOAD LABEL example_db.label_sequence\n    (\n     DATA INFILE("hdfs://host:port/user/data/*/test.txt")\n     INTO TABLE `tbl1`\n     COLUMNS TERMINATED BY ","\n     (k1,k2,source_sequence,v1,v2)\n     ORDER BY source_sequence\n    ) \n    with BROKER "hdfs" ("username"="user", "password"="pass");\n\n15. \u5148\u8fc7\u6ee4\u539f\u59cb\u6570\u636e\uff0c\u5728\u8fdb\u884c\u5217\u7684\u6620\u5c04\u3001\u8f6c\u6362\u548c\u8fc7\u6ee4\u64cd\u4f5c\n\n    LOAD LABEL example_db.label_filter\n    (\n     DATA INFILE("hdfs://host:port/user/data/*/test.txt")\n     INTO TABLE `tbl1`\n     COLUMNS TERMINATED BY ","\n     (k1,k2,v1,v2)\n     PRECEDING FILTER k1 > 2\n     SET (k1 = k1 +1)\n     WHERE k1 > 3\n    ) \n    with BROKER "hdfs" ("username"="user", "password"="pass");\n\n 16. \u5bfc\u5165json\u6587\u4ef6\u4e2d\u6570\u636e  \u6307\u5b9aFORMAT\u4e3ajson\uff0c \u9ed8\u8ba4\u662f\u901a\u8fc7\u6587\u4ef6\u540e\u7f00\u5224\u65ad\uff0c\u8bbe\u7f6e\u8bfb\u53d6\u6570\u636e\u7684\u53c2\u6570\n\n    LOAD LABEL example_db.label9\n    (\n    DATA INFILE("hdfs://hdfs_host:hdfs_port/user/palo/data/input/file")\n    INTO TABLE `my_table`\n    FORMAT AS "json"\n    (k1, k2, k3)\n    properties("fuzzy_parse"="true", "strip_outer_array"="true")\n    )\n    WITH BROKER hdfs ("username"="hdfs_user", "password"="hdfs_password");\n\n 17. LOAD WITH HDFS, \u666e\u901aHDFS\u96c6\u7fa4\n    LOAD LABEL example_db.label_filter\n    (\n        DATA INFILE("hdfs://host:port/user/data/*/test.txt")\n        INTO TABLE `tbl1`\n        COLUMNS TERMINATED BY ","\n        (k1,k2,v1,v2)\n    ) \n    with HDFS (\n        "fs.defaultFS"="hdfs://testFs",\n        "hdfs_user"="user"\n    );\n 18. LOAD WITH HDFS, \u5e26ha\u7684HDFS\u96c6\u7fa4\n    LOAD LABEL example_db.label_filter\n    (\n        DATA INFILE("hdfs://host:port/user/data/*/test.txt")\n        INTO TABLE `tbl1`\n        COLUMNS TERMINATED BY ","\n        (k1,k2,v1,v2)\n    ) \n    with HDFS (\n        "fs.defaultFS"="hdfs://testFs",\n        "hdfs_user"="user"\n        "dfs.nameservices"="my_ha",\n        "dfs.ha.namenodes.xxx"="my_nn1,my_nn2",\n        "dfs.namenode.rpc-address.xxx.my_nn1"="host1:port",\n        "dfs.namenode.rpc-address.xxx.my_nn2"="host2:port",\n        "dfs.client.failover.proxy.provider.xxx"="org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider"\n    );\n')),(0,s.kt)("h2",{id:"keyword"},"keyword"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"BROKER,LOAD\n")))}_.isMDXComponent=!0}}]);