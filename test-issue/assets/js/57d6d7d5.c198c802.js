"use strict";(self.webpackChunkselectdb_portal=self.webpackChunkselectdb_portal||[]).push([[89115],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>b});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=p(n),d=r,b=m["".concat(l,".").concat(d)]||m[d]||u[d]||o;return n?a.createElement(b,i(i({ref:t},c),{},{components:n})):a.createElement(b,i({ref:t},c))}));function b(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[m]="string"==typeof e?e:r,i[1]=s;for(var p=2;p<o;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7059:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const o={title:"RESTORE",language:"en"},i=void 0,s={unversionedId:"sql-reference/sql-statements/Data-Definition/RESTORE",id:"version-0.15/sql-reference/sql-statements/Data-Definition/RESTORE",title:"RESTORE",description:"\x3c!--",source:"@site/versioned_docs/version-0.15/sql-reference/sql-statements/Data-Definition/RESTORE.md",sourceDirName:"sql-reference/sql-statements/Data-Definition",slug:"/sql-reference/sql-statements/Data-Definition/RESTORE",permalink:"/docs/0.15/sql-reference/sql-statements/Data-Definition/RESTORE",draft:!1,tags:[],version:"0.15",frontMatter:{title:"RESTORE",language:"en"},sidebar:"docs",previous:{title:"RECOVER",permalink:"/docs/0.15/sql-reference/sql-statements/Data-Definition/RECOVER"},next:{title:"SHOW ENCRYPTKEYS",permalink:"/docs/0.15/sql-reference/sql-statements/Data-Definition/SHOW-ENCRYPTKEYS"}},l={},p=[{value:"Description",id:"description",level:2},{value:"example",id:"example",level:2},{value:"keyword",id:"keyword",level:2}],c={toc:p};function m(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"restore"},"RESTORE"),(0,r.kt)("h2",{id:"description"},"Description"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"RESTORE\nThis statement is used to restore the data previously backed up by the BACKUP command to the specified database. This command is an asynchronous operation. After successful submission, you need to check progress through the SHOW RESTORE command. Restoring tables of OLAP type is supported only.\nGrammar:\nSNAPSHOT RESTORE ","[dbu name]",".{snapshot name}\nFROM ",(0,r.kt)("inlineCode",{parentName:"li"},"repository_name"),'\nON (\n"',(0,r.kt)("inlineCode",{parentName:"li"},"Table "),"uname'","[",(0,r.kt)("inlineCode",{parentName:"li"},"partition ("),"p1',...)][as `tbl `uu alias']",',\n...\n)\nPROPERTIES ("key"="value", ...);')),(0,r.kt)("p",null,"Explain:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Only one BACKUP or RESTORE task can be performed under the same database."),(0,r.kt)("li",{parentName:"ol"},"The ON clause identifies the tables and partitions that need to be restored. If no partition is specified, all partitions of the table are restored by default. The specified tables and partitions must already exist in the warehouse backup."),(0,r.kt)("li",{parentName:"ol"},"The backup tables in the warehouse can be restored to new tables through AS statements. But the new table name cannot already exist in the database. Partition name cannot be changed."),(0,r.kt)("li",{parentName:"ol"},"The backup tables in the warehouse can be restored and replaced with the same-name tables in the database, but the table structure of the two tables must be completely consistent. Table structure includes: table name, column, partition, Rollup and so on."),(0,r.kt)("li",{parentName:"ol"},"Partitions of the recovery table can be specified, and the system checks whether the partition Range or List matches."),(0,r.kt)("li",{parentName:"ol"},'PROPERTIES currently supports the following attributes:\n"Backup_timestamp" = "2018-05-04-16-45-08": specifies which version of the time to restore the corresponding backup must be filled in. This information can be obtained through the `SHOW SNAPSHOT ON repo;\'statement.\n"Replication_num" = "3": Specifies the number of replicas of the restored table or partition. The default is 3. If an existing table or partition is restored, the number of copies must be the same as the number of copies of an existing table or partition. At the same time, there must be enough hosts to accommodate multiple copies.\n"Timeout" = "3600": Task timeout, default to one day. Unit seconds.\n"Meta_version" = 40: Use the specified meta_version to read the previously backed up metadata. Note that as a temporary solution, this parameter is only used to restore the data backed up by the older version of Doris. The latest version of the backup data already contains meta version, no need to specify.')),(0,r.kt)("h2",{id:"example"},"example"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Restore backup table backup_tbl in snapshot_1 from example_repo to database example_db1 with the time version of "2018-05-04-16-45-08". Restore to one copy:\nRESTORE SNAPSHOT example_db1.',(0,r.kt)("inlineCode",{parentName:"p"},"snapshot_1"),"\nFROM ",(0,r.kt)("inlineCode",{parentName:"p"},"example 'u repo'\nON ( "),'backup_tbl` )\nPROPERTIES\n(\n"backup_timestamp"="2018-05-04-16-45-08",\n"Replication\\ num" = "1"\n);')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Restore the partitions p1, P2 of table backup_tbl in snapshot_2 and table backup_tbl2 to database example_db1 from example_repo and rename it new_tbl. The time version is "2018-05-04-17-11-01". By default, three copies are restored:\nRESTORE SNAPSHOT example_db1.',(0,r.kt)("inlineCode",{parentName:"p"},"snapshot_2"),"\nFROM ",(0,r.kt)("inlineCode",{parentName:"p"},"example 'u repo'\nON\n(\n"),"backup_tbl",(0,r.kt)("inlineCode",{parentName:"p"}," PARTITION ("),"p1",(0,r.kt)("inlineCode",{parentName:"p"},", "),"p2",(0,r.kt)("inlineCode",{parentName:"p"},"),\n"),"backup_tbl2",(0,r.kt)("inlineCode",{parentName:"p"},"AS"),'new_tbl`\n)\nPROPERTIES\n(\n"backup_timestamp"="2018-05-04-17-11-01"\n);'))),(0,r.kt)("h2",{id:"keyword"},"keyword"),(0,r.kt)("p",null,"RESTORE"))}m.isMDXComponent=!0}}]);